<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Generic Functions | whyBother.ts</title>
    <meta name="description" content="TypeScript is a great tool. But if you&#39;re not convinced, it can seem like a lot of work. Why bother?">
    
    
    <link rel="preload" href="/assets/css/0.styles.68be1f38.css" as="style"><link rel="preload" href="/assets/js/app.d77587ef.js" as="script"><link rel="preload" href="/assets/js/10.72b47259.js" as="script"><link rel="prefetch" href="/assets/js/11.0e0d60a3.js"><link rel="prefetch" href="/assets/js/2.31a4bbf8.js"><link rel="prefetch" href="/assets/js/3.e45db2c9.js"><link rel="prefetch" href="/assets/js/4.7e2981d4.js"><link rel="prefetch" href="/assets/js/5.185e1798.js"><link rel="prefetch" href="/assets/js/6.75bc1e6c.js"><link rel="prefetch" href="/assets/js/7.e81a9002.js"><link rel="prefetch" href="/assets/js/8.54dd1f62.js"><link rel="prefetch" href="/assets/js/9.edd2702c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.68be1f38.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-navbar"><!----> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"> <a href="https://github.com/bgschiller/whybother-ts" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/" class="sidebar-link">whyBother.ts</a></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Money for Nothing</span> <span class="arrow right"></span></p> <!----></div></li><li><a href="/exhaustiveness-checking/" class="sidebar-link">Exhaustiveness Checking</a></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>Okay, I'm Convinced</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/okay-im-convinced/" class="sidebar-link">But what's this lever do?</a></li><li><a href="/okay-im-convinced/generic-functions/" class="active sidebar-link">Generic Functions</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="generic-functions"><a href="#generic-functions" aria-hidden="true" class="header-anchor">#</a> Generic Functions</h1> <p>Let's think about a simple log function</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> <span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>I find it to be more useful than <code>console.log</code> on its own because I can use it in big chains to see what's going on.</p> <div class="language-typescript line-numbers-mode"><div class="highlight-lines"><br><br><div class="highlighted"> </div><br><div class="highlighted"> </div><br><br></div><pre class="language-typescript"><code><span class="token keyword">const</span> commandLineArgs <span class="token operator">=</span> args
  <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>validate<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>log<span class="token punctuation">)</span> <span class="token comment">// logs values without modifying them</span>
  <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>differentThanDefault<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>log<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span>collect<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>But what's its type signature? As it stands, the function accepts an <code>any</code> argument and returns an <code>any</code> value. We do want it to work for any possible value, but by returning an <code>any</code> we are interfering with TypeScript's ability to track the types of values.</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> nums<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> squares <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x <span class="token operator">*</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// inferred as number[]</span>
<span class="token keyword">const</span> loggedSquares <span class="token operator">=</span> <span class="token function">log</span><span class="token punctuation">(</span>squares<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// inferred as any</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>This is a problem because if TypeScript thinks our value is of type <code>any</code> rather than <code>number[]</code>, it won't catch when we make a mistake:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// Error: Operator '+' cannot be applied to types number[] and 5</span>
<span class="token keyword">const</span> plusFive <span class="token operator">=</span> squares <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">;</span>

<span class="token comment">// no complaint from TS</span>
<span class="token keyword">const</span> loggedPlusFive <span class="token operator">=</span> loggedSquares <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>What we really want to say is not &quot;<code>log</code> accepts an arg of any type and returns a value of any type&quot; but rather &quot;<code>log</code> accepts an arg of some type and returns a value of <em>that same type</em>&quot;. Generic Functions give us a way to do this. Let's rewrite our <code>log</code> function using generics.</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> log<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token constant">T</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>The <code>&lt;T&gt;</code> syntax introduces what's called a &quot;type variable&quot; or &quot;type parameter&quot;. Just how function parameters are stand-ins for a value that will be determined later, a type variable is a stand-in for a <em>type</em> that will be determined later. Giving a name to the type is how we're able to specify &quot;<code>log</code> accepts a variable of some type <code>T</code> and returns a variable of that same type <code>T</code>&quot;.</p> <h3 id="type-parameter-inference"><a href="#type-parameter-inference" aria-hidden="true" class="header-anchor">#</a> Type Parameter Inference</h3> <p>In rare occasions, you may need to specify what concrete types you want in your type parameters. Most of the time, TypeScript will figure it out for you. Using our <code>log</code> function from before:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> x<span class="token punctuation">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>

log<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// you're allowed to specify what type you want</span>
<span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// TS knows x is a number, so it figures out that log&lt;T&gt; should be log&lt;number&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="type-parameters-in-other-languages"><a href="#type-parameters-in-other-languages" aria-hidden="true" class="header-anchor">#</a> Type parameters in other languages</h3> <p>Sometimes it's helpful to see how the same concept looks in other languages. Python is another language that recently had a type system bolted on top of it. In python, we need to declare a value as a type parameter before using it.</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> typing <span class="token keyword">import</span> Sequence<span class="token punctuation">,</span> TypeVar

T <span class="token operator">=</span> TypeVar<span class="token punctuation">(</span><span class="token string">'T'</span><span class="token punctuation">)</span>  <span class="token comment"># Declare the type variable</span>

<span class="token keyword">def</span> <span class="token function">first</span><span class="token punctuation">(</span>lst<span class="token punctuation">:</span> Sequence<span class="token punctuation">[</span>T<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> T<span class="token punctuation">:</span>
  <span class="token keyword">return</span> lst<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>Without that <code>T = TypeVar('T')</code> declaration, python would go looking for a nearby or imported type called literally <code>T</code>. Probably, it would fail with a <code>NameError</code> when it didn't find a type of that name. Worse, maybe there <em>is</em> a type called <code>T</code>, and we've unwittingly written a function that only works on values of that type. By declaring it as a <code>TypeVar</code>, we're telling the typechecker: &quot;There isn't really a type called <code>T</code>. Instead, <code>T</code> is a placeholder for a type to be decided later.</p> <p>In my opinion, TypeScript's <code>&lt;T&gt;</code> is a nicer syntax, but it serves the same purpose.</p> <h3 id="multiple-type-parameters"><a href="#multiple-type-parameters" aria-hidden="true" class="header-anchor">#</a> Multiple Type Parameters</h3> <p>Some functions' type definitions have two or more type variables. <code>map</code> is a common example: It takes an array of some type (the first type parameter), a function from that first type to another type, and returns an array of that second type. It's even hard to write about without using names! Let's try again with names:</p> <blockquote><p><code>map</code> accepts an array of some type <code>T</code>, a function from <code>T</code> to another type <code>R</code>, and produces an array of <code>R</code>.</p></blockquote> <p>With practice, the TypeScript syntax will become easier to read than the english. Here's what it looks like for map:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> map<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">R</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>lst<span class="token punctuation">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> mapper<span class="token punctuation">:</span> <span class="token punctuation">(</span>t<span class="token punctuation">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">R</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token constant">R</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>And once more, with descriptions alongside</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">function</span> map
  <span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">R</span><span class="token operator">&gt;</span><span class="token punctuation">(</span> <span class="token comment">// for some types T and R</span>
    lst<span class="token punctuation">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// lst is an array of T</span>
    mapper<span class="token punctuation">:</span> <span class="token punctuation">(</span>t<span class="token punctuation">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">R</span> <span class="token comment">// mapper is a function from T to R</span>
  <span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token constant">R</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// The return value is an array of R</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="references"><a href="#references" aria-hidden="true" class="header-anchor">#</a> References</h3> <ul><li><a href="https://www.typescriptlang.org/docs/handbook/generics.html" target="_blank" rel="noopener noreferrer">the TypeScript docs on Generics<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/bgschiller/whybother-ts/edit/master/okay-im-convinced/generic-functions/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/okay-im-convinced/" class="prev router-link-active">
          But what's this lever do?
        </a></span> <!----></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.d77587ef.js" defer></script><script src="/assets/js/10.72b47259.js" defer></script>
  </body>
</html>
